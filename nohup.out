Building DAG of jobs...
Job stats:
job              count    min threads    max threads
-------------  -------  -------------  -------------
export_mosaic        1              1              1
four_pop             1              1              1
get_R2_score         1              1              1
run_RFMix2           1              1              1
run_bmix             1              1              1
run_mosaic           1              1              1
total                6              1              1


[Fri Oct 22 10:42:11 2021]
rule run_RFMix2:
    input: results/OutOfAfrica_4J17/4pop_79/4pop_test/phased.target_inds.vcf.gz, results/OutOfAfrica_4J17/4pop_79/4pop_test/phased.reference_inds.vcf.gz, results/OutOfAfrica_4J17/4pop_79/4pop_test/sample_map.txt, results/OutOfAfrica_4J17/4pop_79/4pop_test/genetic_map.txt
    output: results/OutOfAfrica_4J17/4pop_79/4pop_test/RFMix2/rfmix2.fb.tsv
    log: results/OutOfAfrica_4J17/4pop_79/4pop_test/RFMix2/rfmix2.log
    jobid: 17
    benchmark: results/OutOfAfrica_4J17/4pop_79/4pop_test/benchmark/run_RFMix2.tsv
    wildcards: model_name=OutOfAfrica_4J17, sim_name=4pop_79, anal_name=4pop_test
    resources: tmpdir=/tmp


[Fri Oct 22 10:42:11 2021]
rule run_bmix:
    input: results/OutOfAfrica_4J17/4pop_79/4pop_test/phased.target_inds.vcf.gz, results/OutOfAfrica_4J17/4pop_79/4pop_test/phased.reference_inds.vcf.gz, results/OutOfAfrica_4J17/4pop_79/4pop_test/sample_map.txt, results/OutOfAfrica_4J17/4pop_79/4pop_test/plink_map.txt
    output: results/OutOfAfrica_4J17/4pop_79/4pop_test/bmix/bmix.anc.vcf.gz
    jobid: 18
    benchmark: results/OutOfAfrica_4J17/4pop_79/4pop_test/benchmark/run_bmix.tsv
    wildcards: model_name=OutOfAfrica_4J17, sim_name=4pop_79, anal_name=4pop_test
    resources: tmpdir=/tmp


[Fri Oct 22 10:42:11 2021]
rule run_mosaic:
    input: programs/MOSAIC/MOSAIC/mosaic.R, results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/input/admixedgenofile.22
    output: results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/localanc_admixed.RData, results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/admixed.RData
    log: results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/mosaic.log
    jobid: 8
    benchmark: results/OutOfAfrica_4J17/4pop_79/4pop_test/benchmark/run_mosaic.tsv
    wildcards: model_name=OutOfAfrica_4J17, sim_name=4pop_79, anal_name=4pop_test
    resources: tmpdir=/tmp


[Fri Oct 22 10:42:11 2021]
rule export_mosaic:
    input: results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/localanc_admixed.RData, results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/admixed.RData
    output: results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/la_probs.RData
    jobid: 7
    wildcards: model_name=OutOfAfrica_4J17, sim_name=4pop_79, anal_name=4pop_test
    resources: tmpdir=/tmp

[Fri Oct 22 10:42:11 2021]
rule get_R2_score:
    input: results/OutOfAfrica_4J17/4pop_79/4pop_test/true_local_ancestry.site_matrix.npz, results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/la_probs.RData, results/OutOfAfrica_4J17/4pop_79/4pop_test/RFMix2/rfmix2.fb.tsv, results/OutOfAfrica_4J17/4pop_79/4pop_test/bmix/bmix.anc.vcf.gz
    output: results/OutOfAfrica_4J17/4pop_79/4pop_test/SUMMARY/R2_score.ancestry.tsv, results/OutOfAfrica_4J17/4pop_79/4pop_test/SUMMARY/R2_score.individuals.tsv
    jobid: 1
    wildcards: model_name=OutOfAfrica_4J17, sim_name=4pop_79, anal_name=4pop_test
    resources: tmpdir=/tmp

[Fri Oct 22 10:42:11 2021]
localrule four_pop:
    input: results/OutOfAfrica_4J17/4pop_79/4pop_test/SUMMARY/R2_score.individuals.tsv
    jobid: 0
    resources: tmpdir=/tmp

Job stats:
job              count    min threads    max threads
-------------  -------  -------------  -------------
export_mosaic        1              1              1
four_pop             1              1              1
get_R2_score         1              1              1
run_RFMix2           1              1              1
run_bmix             1              1              1
run_mosaic           1              1              1
total                6              1              1

This was a dry-run (flag -n). The order of jobs does not reflect the order of execution.
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cluster nodes: 1
Job stats:
job              count    min threads    max threads
-------------  -------  -------------  -------------
export_mosaic        1              1              1
four_pop             1              1              1
get_R2_score         1              1              1
run_RFMix2           1              1              1
run_bmix             1              1              1
run_mosaic           1              1              1
total                6              1              1

Select jobs to execute...

[Fri Oct 22 10:43:44 2021]
rule run_mosaic:
    input: programs/MOSAIC/MOSAIC/mosaic.R, results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/input/admixedgenofile.22
    output: results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/localanc_admixed.RData, results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/admixed.RData
    log: results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/mosaic.log
    jobid: 8
    benchmark: results/OutOfAfrica_4J17/4pop_79/4pop_test/benchmark/run_mosaic.tsv
    wildcards: model_name=OutOfAfrica_4J17, sim_name=4pop_79, anal_name=4pop_test
    resources: tmpdir=/tmp

Submitted job 8 with external jobid 'Your job 40506 ("analyze4pop") has been submitted'.
[Fri Oct 22 10:44:24 2021]
Error in rule run_mosaic:
    jobid: 8
    output: results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/localanc_admixed.RData, results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/admixed.RData
    log: results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/mosaic.log (check log file(s) for error message)
    shell:
        
		Rscript programs/MOSAIC/MOSAIC/mosaic.R --seed 98 --maxcores 8 --chromosomes 22:22 --ancestries 4 admixed results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/input/ 2>&1 | tee results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC/mosaic.log

		

		# move the results into the MOSAIC folder
		mv MOSAIC_RESULTS/* results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC
		mv MOSAIC_PLOTS/* results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC
		mv FREQS/* results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC
		rmdir MOSAIC_RESULTS
		rmdir MOSAIC_PLOTS
		rmdir FREQS

		# try to fix the naming mess here
		cd results/OutOfAfrica_4J17/4pop_79/4pop_test/MOSAIC
		find localanc_admixed_*.RData -exec cp {} localanc_admixed.RData \;
		find admixed_*.RData -exec cp {} admixed.RData \;

		
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: Your job 40506 ("analyze4pop") has been submitted

Error executing rule run_mosaic on cluster (jobid: 8, external: Your job 40506 ("analyze4pop") has been submitted, jobscript: /home/users/waplesr/lai/lai-sim/.snakemake/tmp.uys9o307/snakejob.run_mosaic.8.sh). For error details see the cluster log and the log files of the involved rule(s).
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /home/users/waplesr/lai/lai-sim/.snakemake/log/2021-10-22T104342.331344.snakemake.log
